

var oOutput = Context.createOutputObject();
var xlTableActive=false;

//oOutput.SetTitle(Context.getScriptInfo(Constants.SCRIPT_NAME));

var nLocale = Context.getSelectedLanguage();

var isklproc = "";

 var aSelModels  = ArisData.getSelectedModels( Context.getDefinedItemTypes(Constants.CID_MODEL) );
 var ga_ProcessModels    = [Constants.MT_VAL_ADD_CHN_DGM];
 var g_nloc = 0;
 var gn_Lang         = Context.getSelectedLanguage();


var g_nloc = Context.getSelectedLanguage(); 
var ogroupmodels = ArisData.getSelectedModels(); // выбранная пользователем группа моделей, на которых запущен скрипт
var osinglemodel = ogroupmodels[0];              // выбираем первую модель из массива   
var omodellistglobal = new Array();

var ooutfile = null; 
var txtCenterText = getString ("TEXT_1");        // Copyright надпись
var txtCurrentYear = new Date().getFullYear();   // переменная текущего года
var txtTypeDiagram = getString ("TEXT_4");       // Название типа диаграммы цепочки добавленного качества
var txtCity = getString ("TEXT_5");              // Название города
//AS20160209
var ed = getString ("TEXT_6");  // В электром виде - объекты типа электронный документ

/* итоговые переменные всего функицй, автоматизированных функций, подлежащих автоматизации функции,
неавтоматизированных функциий, контрольных функций */
var totfunc = 0, totavtfunc = 0, totshldavtfunc = 0, totnoavtfunc = 0, totcontrolfunc = 0;
var ident = ""; // переменная для нумерации модели
var identBool = true;

var groupfuncobjects = osinglemodel.ObjOccListFilter(Constants.OT_FUNC); // фильтр только функции
var ooutobjocclist = new Array();
var ooutobjocclist1 = new Array();
var oinpobjocclist = new Array();
var firstcolmatrixagr = new Array("Соответствие модели БП целям описания БП, указанным в ходатайстве");
var expertnum;
var ocurrentobj;
var bstrdesc;
var strRegExp = new SearchRegExp();

var aSelModels  = ArisData.getSelectedModels( Context.getDefinedItemTypes(Constants.CID_MODEL) )


function main() {
    
    Context.setProperty("use-new-output", true);
    ooutfile = Context.createOutputObject(Context.getSelectedFormat(), Context.getSelectedFile());
    ooutfile.Init(Context.getSelectedLanguage());
   
    
    
        var hld_oOutputFile     = new __holder( ooutfile );
        var hld_nOutGraphic     = new __holder(0);
        var hld_nAssgnLevel     = new __holder(0);
            hld_nOutGraphic.value   = true ;
            hld_nAssgnLevel.value   = 1;
     
    //сортируем по расположению объектов в модели
    groupfuncobjects = ArisData.sort(groupfuncobjects, Constants.AT_HIER_NUM, Constants.SORT_GEOMETRIC, g_nloc);
    
    // Создаем объект типа *.doc
    
    ooutfile.Init(g_nloc);
    
    // Параметры страницы  
    //PortraitPage(false, ooutfile);
    ooutfile.SetPrintScaling(120);
    
    
ooutfile.DefineF("ID_STYLE_RD_HEADER_FOOTER", "Times New Roman", 10, Constants.C_TRANSPARENT,  Constants.FMT_LEFT| Constants.FMT_VTOP, 0, 0, 0, 0, 0,0, 1);
ooutfile.DefineF("ID_STYLE_RD_DEFAULT", "Times New Roman", 11,  Constants.C_TRANSPARENT,  Constants.FMT_LEFT| Constants.FMT_VTOP, 0, 0, 0, 0, 0,0, 1);
ooutfile.DefineF("ID_STYLE_RD_TABLE_HEAD", "Times New Roman", 8,  Constants.C_TRANSPARENT,  Constants.FMT_BOLD | Constants.FMT_CENTER| Constants.FMT_VTOP, 0, 0, 0, 0, 0, 0,1);
ooutfile.DefineF("ID_STYLE_RD_TABLE_CONTENT","Times New Roman", 8,  Constants.C_TRANSPARENT,  Constants.FMT_LEFT| Constants.FMT_VTOP, 0, 0, 0, 0, 0,0,1);
ooutfile.DefineF("ID_STYLE_RD_INFO", "Times New Roman", 14,  Constants.C_TRANSPARENT,  Constants.FMT_BOLD | Constants.FMT_CENTER| Constants.FMT_VTOP, 0, 0, 1.76, 8.82, 0,0, 1);
ooutfile.DefineF("ID_STYLE_RD_HEADING_3", "Times New Roman", 12,  Constants.C_TRANSPARENT,  Constants.FMT_ITALIC | Constants.FMT_BOLD | Constants.FMT_LEFT| Constants.FMT_VTOP| Constants.FMT_TOCENTRY2 , 0, 0, 1, 1, 0, 0,1);
ooutfile.DefineF("ID_STYLE_RD_HEADING_4", "Times New Roman", 12,  Constants.C_TRANSPARENT,  Constants.FMT_ITALIC | Constants.FMT_BOLD | Constants.FMT_LEFT| Constants.FMT_VTOP| Constants.FMT_TOCENTRY3 , 0, 0, 0, 0, 0, 0,1);
ooutfile.DefineF("ID_STYLE_RD_HEADING_1", "Times New Roman", 18,  Constants.C_TRANSPARENT,  Constants.FMT_BOLD | Constants.FMT_LEFT| Constants.FMT_VTOP| Constants.FMT_TOCENTRY0 , 0, 0, 4, 4, 0, 0,1);
ooutfile.DefineF("ID_STYLE_RD_TITLE", "Times New Roman", 21,  Constants.C_TRANSPARENT,  Constants.FMT_BOLD | Constants.FMT_CENTER| Constants.FMT_VTOP, 0, 0, 1.76, 8.82, 0, 0,1);
ooutfile.DefineF("ID_STYLE_RD_HEADING_2", "Times New Roman", 14,  Constants.C_TRANSPARENT,  Constants.FMT_ITALIC | Constants.FMT_BOLD | Constants.FMT_LEFT| Constants.FMT_VTOP| Constants.FMT_TOCENTRY1 , 0, 0, 2, 2, 0, 0,1);

    
    //	Cтили, используемые для вывода заголовков и таблиц
    ooutfile.DefineF("Heading 0", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 1", "Times New Roman",14,Constants.C_BLACK,Constants.C_WHITE, Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 2", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 3", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 4", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 5", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 6", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 7", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 8", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("Heading 9", "Times New Roman",12,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,0);
    ooutfile.DefineF("TableTop", "Times New Roman",10,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_BOLD | Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("TableEnd", "Times New Roman",13,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_BOLD | Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("TableLeftEnd", "Times New Roman",13,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,1);
    ooutfile.DefineF("TableBottom", "Times New Roman",10,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,1);
    //AS20160201
    ooutfile.DefineF("TableBottom2", "Times New Roman",10,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_UNDERLINE | Constants.FMT_BOLD | Constants.FMT_LEFT,0,0,0,0,0,1);
    
    ooutfile.DefineF("Pic", "Times New Roman", 12,Constants.C_BLACK, Constants.C_TRANSPARENT, Constants.FMT_LEFT, 0,0,0,0,0,1);
    
    ooutfile.DefineF("TableMain", "Times New Roman",10,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_LEFT,0,0,0,0,0,1);
    ooutfile.DefineF("TableMain_2", "Times New Roman",10,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_JUSTIFY,0,0,0,0,0,1);
    ooutfile.DefineF("TableAttn", "Times New Roman",10,Constants.C_RED,Constants.C_WHITE,Constants.FMT_LEFT,0,0,0,0,0,1);
    ooutfile.DefineF("Header", "Times New Roman",15,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("HeaderMatrix", "Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("StringTable1", "Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_LEFT,0,0,0,0,0,1);
    ooutfile.DefineF("StringTable2", "Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("Footer", "Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("Title 1", "Times New Roman",15,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_LEFT,95,0,0,0,0,1);      
    ooutfile.DefineF("Title 2", "Times New Roman",15,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_RIGHT,0,0,0,0,0,0);
    ooutfile.DefineF("Title 3", "Times New Roman",15,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("Title 4", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_LEFT,90,0,0,0,0,1);
    ooutfile.DefineF("Title 5", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_JUSTIFY,0,0,0,0,0,1);
    ooutfile.DefineF("Title 6", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("Title 26", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_RIGHT,0,0,0,0,0,1);
    ooutfile.DefineF("Title 16", "Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("Title 7", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_RIGHT,0,0,0,0,0,1); 
    ooutfile.DefineF("Title 8", "Times New Roman",14, Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_BOLD | Constants.FMT_JUSTIFY,0,0,0,0,0,1);
    ooutfile.DefineF("Title 9", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_ITALIC | Constants.FMT_CENTER,0,0,0,0,0,1);
    ooutfile.DefineF("Title 10", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_LEFT,0,0,0,0,0,1);
    ooutfile.DefineF("Title 11", "Times New Roman",14,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_JUSTIFY,0,75,0,0,0,1);
    ooutfile.DefineF("Title 12", "Times New Roman",14, Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_BOLD | Constants.FMT_ITALIC | Constants.FMT_JUSTIFY,0,0,0,0,0,1);

    
    if (ogroupmodels.length > 0) {
    //    userdialog();
        if (bcheckuserdialog = true) {
           rechPPK();
       //     ToC(ooutfile);  
       
            
         //   var aSelModels  = ArisData.getSelectedModels( Context.getDefinedItemTypes(Constants.CID_MODEL) );
           
              outputDataPerModel(hld_oOutputFile, hld_nOutGraphic.value);
              
              
            // выводим модели 1. управляющие
       //     outputDataPerModel1( aSelModels, hld_oOutputFile, hld_nOutGraphic.value, hld_nAssgnLevel.value, 0, nom1 ); 
       //     createSection1(ooutfile, ArisData.getActiveDatabase(), nom6, nom6n, namtab);
           
                  
         ooutfile.WriteReport(Context.getSelectedPath(), Context.getSelectedFile());
        } else {
            Context.setScriptError(Constants.ERR_NOFILECREATED);
        }
    } else {
        Dialogs.MsgBox("Выберите, пожалуйста, модель",Constants.MSGBOX_BTN_OK,"ARIS Report");
        Context.setScriptError(Constants.ERR_NOFILECREATED);  
    }  


function rechPPK()
{  
  
    // Вывод решения ППК
    ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
    ooutfile.OutputLnF("Проект","Title 7");
    ooutfile.OutputLnF("","Title 5");
    ooutfile.OutputLnF("Решение Проектно-процессного комитета ОАО «Белагропромбанк»","Title 6");
    ooutfile.OutputLnF("Об утверждении изменений и дополнений в Модель (дерево) бизнес-процессов \nОАО «Белагропромбанк» верхнего уровня в состоянии «как есть»","Title 6");
    ooutfile.OutputLnF("(Сергель Н.Н.)","Title 6");
    ooutfile.OutputLnF("","Title 5");
    ooutfile.OutputLnF("\t\t\t\t\t\t\t\t\tРассмотрев представленные материалы, предварительно согласованные с владельцами бизнес-процессов Банка, и заслушав заместителя директора Проектно-процессного офиса Сергель Н.Н., ","Title 5");
    ooutfile.OutputLnF("\t\t\t\t\t\t\t\t\tПроектно-процессный комитет РЕШИЛ:","Title 5");
    ooutfile.OutputLnF("\t\t\t\t\t\t\t\t\t1. Утвердить изменения и дополнения в Модель (дерево) бизнес-процессов ОАО «Белагропромбанк» верхнего уровня в состоянии «как есть», утвержденную распоряжением ОАО «Белагропромбанк» от 15.03.2019 № 170 (прилагается) (далее – изменения и дополнения).","Title 5");
    ooutfile.OutputLnF("\t\t\t\t\t\t\t\t\t2. Установить, что изменения и дополнения вступают в силу с 18.02.2020.","Title 5");
    ooutfile.OutputLnF("\t\t\t\t\t\t\t\t\t3. Руководителям структурных подразделений ОАО «Белагропромбанк» обеспечить применение изменений и дополнений в рамках процессного подхода к управлению операционным риском (при регистрации фактов реализации операционного риска), а также при описании и оптимизации бизнес-процессов ОАО «Белагропромбанк», актуализации моделей бизнес-процессов.","Title 5");
    ooutfile.OutputLnF("","Title 5");
    ooutfile.OutputLnF("Директор Проектно-процессного офиса 	                             Е.В.Маковик","Title 5");
    ooutfile.EndSection();
  



}    
    
    
    
function userdialog()
{
    
    var bInput = false ;	
    var listbox = new Array(1,2,3,4,5,6,7,8,9); 
    var txtDialogTitle = getString ("TEXT_3"); // Название диалогового пользовательского окна    
    var dialoglogo = Context.getFile("LogoAPB.JPG",Constants.LOCATION_COMMON_FILES);
    
    var userdialog = Dialogs.createNewDialogTemplate(600, 170, txtDialogTitle);
    userdialog.Picture(1,2,220,25, "LOGO");    
    userdialog.CheckBox(50,30,520,14,"Выводить в отчет вложенную модель, на которую ссылается PI и в поле TEXT IN", "Check1");
    userdialog.CheckBox(50,45,490,14,"Выводить в отчет таблицу уровня автоматизации БП", "Check2");
    userdialog.CheckBox(50,60,490,14, "Выводить в отчет итоговую таблицу степени автоматизации БП", "Check3");
    userdialog.CheckBox(50,75,490,14, "Выводить список детализирующих моделей - модели VAD", "Check4");
    userdialog.CheckBox(50,90,490,14, "Выводить только функции, требующие автоматизации", "Check5");
    userdialog.Text(50,118,320,14,"Количество экспертов (включая владельца)");
    userdialog.ComboBox(325,120,55,16,listbox ,"Text0");
    userdialog.Text(50,138,335,14,"Стартовый номер подпроцесса");
    userdialog.TextBox(327,140,70,16, "Text1", 0);
    userdialog.OKButton();
    userdialog.CancelButton();
    
    dlgGroupInfo = Dialogs.createUserDialog(userdialog);
    dlgGroupInfo.setDlgPicture("LOGO", dialoglogo, 1);
    dlgGroupInfo.setDlgValue(1, true);
    dlgGroupInfo.setDlgValue(2, false);
    dlgGroupInfo.setDlgValue(3, false);
    dlgGroupInfo.setDlgValue(4, true);
    dlgGroupInfo.setDlgText(7,"1");
    dlgGroupInfo.setDlgText(9,"1.");
    
    var nuserdialog=Dialogs.show(dlgGroupInfo);
    
    if (nuserdialog != 0) {
        bcheckuserdialog = true;    
        expertnum=dlgGroupInfo.getDlgText("Text0");
        expertnum++;
        ident=dlgGroupInfo.getDlgText("Text1");
        bpicheck=(dlgGroupInfo.getDlgValue("Check1") == 1);
        bcheck2=(dlgGroupInfo.getDlgValue("Check2") == 1);
        bcheck3=(dlgGroupInfo.getDlgValue("Check3") == 1);
        bcheck4=(dlgGroupInfo.getDlgValue("Check4") == 1);
        bcheck5=(dlgGroupInfo.getDlgValue("Check5") == 1);
    } else {bcheckuserdialog=false;}
}   


function outputDataPerModel(hld_oOutputFile, p_bOutGraphic ){
    //    ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
    ooutfile.OutputLnF("УТВЕРЖДЕНО","Title 4");
    ooutfile.OutputLnF("Решение Проектно-процессный комитет\nОАО «Белагропромбанк»\n___.___20__ № ___","Title 4");
    ooutfile.OutputLnF("ИЗМЕНЕНИЯ И ДОПОЛНЕНИЯ","Title 10");
    ooutfile.OutputLnF("в Модель (дерево) бизнес-процессов ОАО «Белагропромбанк» верхнего уровня в состоянии «как есть», утвержденную распоряжением ОАО «Белагропромбанк» от 15.03.2019 № 170","Title 11");
    ooutfile.OutputLnF("","Title 5");
        var p_Output    = hld_oOutputFile.value;
        
        var gr          = ArisData.getActiveDatabase().FindGUID("7fed8651-f4bc-11e5-1e27-0017a4772806");
        var aOut        = new Array();
        var aOut1       = new Array();
        var p_aObjDef   = new Array();
        var p_aObjDef1  = new Array();
        var aAllOccs    = new Array(); 
        var aAllOccs   = gr.ModelList(true, [Constants.MT_VAL_ADD_CHN_DGM]); 
   //     
        ArisData.Unique(aAllOccs);
        aAllOccs =  ArisData.sort(aAllOccs,Constants.AT_NAME, nLocale);
      //  aAllOccs.sort(sortDefsNames);
       
       
       
       
        if( aAllOccs.length > 0 )  
        
   /*
        for(var iok=0; iok<aAllOccs.length; iok++) {
        
        p_aObjDef = p_aObjDef.concat(aAllOccs[iok].ObjOccListFilter(Constants.OT_FUNC));  
       
     }
      p_aObjDef = ArisData.Unique(p_aObjDef); 
      if (p_aObjDef.length > 0) { 
         p_aObjDef1 = ArisData.sort(p_aObjDef,Constants.AT_HIER_NUM, nLocale);
      for(var ipk=0; ipk<p_aObjDef1.length; ipk++) {
	            aAllOccs = aAllOccs.concat(p_aObjDef1[ipk].ObjDef().AssignedModels(Constants.MT_VAL_ADD_CHN_DGM).filter(function (amodel){
                    return ((amodel.Name(g_nloc).startsWith("1."))||(amodel.Name(g_nloc).startsWith("2."))||(amodel.Name(g_nloc).startsWith("3."))||(amodel.Name(g_nloc).startsWith("4."))   )}));
      }
     //  aAllOccs = ArisData.Unique(aAllOccs);
                      
      }

       */
        for(var i=0; i<aAllOccs.length; i++){
       //   ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);   
          if (SqlDate(aAllOccs[i].Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") || 
              SqlDate(aAllOccs[i].Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") || 
              SqlDate(aAllOccs[i].Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) > SqlDate("15.10.2019"))
              
          {
            
         //     ooutfile.BeginSection(false, Constants.SECTION_DEFAULT); 
                outputGraphic(aAllOccs[i]);
       //       ooutfile.EndSection();  
           ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);  
           if (!(aAllOccs[i].Name(g_nloc).startsWith("1.   ") || aAllOccs[i].Name(g_nloc).startsWith(" Верх") || aAllOccs[i].Name(g_nloc).startsWith("2.  ")
                  || aAllOccs[i].Name(g_nloc).startsWith("3. ") || aAllOccs[i].Name(g_nloc).startsWith("3.1.  ") || aAllOccs[i].Name(g_nloc).startsWith("3.2.  ") 
                  || aAllOccs[i].Name(g_nloc).startsWith("3.3.  ") || aAllOccs[i].Name(g_nloc).startsWith("3.4.  ") || aAllOccs[i].Name(g_nloc).startsWith("4. ")) )
          {
            var grfun = aAllOccs[i].ObjOccListFilter(Constants.OT_FUNC);
              grfun = ArisData.Unique(grfun);
              grfun = ArisData.sort(grfun,Constants.AT_HIER_NUM, nLocale);
              
              for(var iip=0; iip<grfun.length; iip++){
          //        ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
                  var aAsgnModels = grfun[iip].ObjDef().AssignedModels(Constants.MT_VAL_ADD_CHN_DGM).filter(function (amodel){
                    return (((amodel.Name(g_nloc).startsWith("_Окружение"))||(amodel.Name(g_nloc).startsWith("Н_Окружение"))) && 
                  (SqlDate(amodel.Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") || 
                  SqlDate(amodel.Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") || 
                  SqlDate(amodel.Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) > SqlDate("15.10.2019"))  )});
             //   ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
             if (aAsgnModels[0] != null && SqlDate(aAsgnModels[0].Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") && 
                 SqlDate(aAsgnModels[0].Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) < SqlDate("15.10.2019"))  { 
                     ooutfile.OutputLnF( "В таблице подпункт "+aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc).split(" ").shift()+  " изложить в следующей редакции:"+"\n\«","Heading 1" ); 
                  createSection33(ooutfile, ArisData.getActiveDatabase(), aAsgnModels);
                  ooutfile.OutputLnF( "\»;","Title 26" );
             }
             if (aAsgnModels[0] != null && SqlDate(aAsgnModels[0].Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") ) { 
                  ooutfile.OutputLnF( "В таблице подпункт "+aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc).split(" ").shift()+  " исключить"+".","Heading 1" ); 
                //  createSection33(ooutfile, ArisData.getActiveDatabase(), aAsgnModels);
             }   
             if (aAsgnModels[0] != null && SqlDate(aAsgnModels[0].Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) > SqlDate("15.10.2019") ) { 
                     ooutfile.OutputLnF( "В таблице дополнить подпунктом "+ aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc).split(" ").shift()+ " следующего содержания:"+"\n\«"+ aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc),"Heading 1" ); 
                 createSection33(ooutfile, ArisData.getActiveDatabase(), aAsgnModels);
                 ooutfile.OutputLnF( "\»;","Title 26" );
             }
             {}
          //   ooutfile.EndSection();  
            }
          }
            ooutfile.EndSection();
          }else{
              if (!(aAllOccs[i].Name(g_nloc).startsWith("1.   ") || aAllOccs[i].Name(g_nloc).startsWith(" Верх") || aAllOccs[i].Name(g_nloc).startsWith("2.  ")
                  || aAllOccs[i].Name(g_nloc).startsWith("3. ") || aAllOccs[i].Name(g_nloc).startsWith("3.1.  ") || aAllOccs[i].Name(g_nloc).startsWith("3.2.  ") 
                  || aAllOccs[i].Name(g_nloc).startsWith("3.3.  ") || aAllOccs[i].Name(g_nloc).startsWith("3.4.  ") || aAllOccs[i].Name(g_nloc).startsWith("4. ")) )
          {
           
            ooutfile.BeginSection(false, Constants.SECTION_DEFAULT); 
            var grfun = aAllOccs[i].ObjOccListFilter(Constants.OT_FUNC);
              grfun = ArisData.Unique(grfun);
              grfun = ArisData.sort(grfun,Constants.AT_HIER_NUM, nLocale);
             for(var iil=0; iil<grfun.length; iil++){
                
                  var aAsgnModels = grfun[iil].ObjDef().AssignedModels(Constants.MT_VAL_ADD_CHN_DGM).filter(function (amodel){
                    return ((amodel.Name(g_nloc).startsWith("_Окружение")||amodel.Name(g_nloc).startsWith("Н_Окружение")) && 
                  (SqlDate(amodel.Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") || 
                  SqlDate(amodel.Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020")|| 
                  SqlDate(amodel.Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) > SqlDate("15.10.2019"))  )});
             //   ooutfile.BeginSection(false, Constants.SECTION_DEFAULT); 
             if (aAsgnModels[0] != null && SqlDate(aAsgnModels[0].Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") && 
             SqlDate(aAsgnModels[0].Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) < SqlDate("15.10.2019"))  { 
                     ooutfile.OutputLnF( "В таблице подпункт "+aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc).split(" ").shift()+  " изложить в следующей редакции:"+"\n\«","Heading 1" ); 
                 createSection33(ooutfile, ArisData.getActiveDatabase(), aAsgnModels);
                 ooutfile.OutputLnF( "\»;","Title 26" );
             }
             if (aAsgnModels[0] != null && SqlDate(aAsgnModels[0].Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020") ) { 
                     ooutfile.OutputLnF( "В таблице подпункт "+aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc).split(" ").shift()+  " исключить"+".","Heading 1" ); 
            //      createSection33(ooutfile, ArisData.getActiveDatabase(), aAsgnModels);
             }   
             if (aAsgnModels[0] != null && SqlDate(aAsgnModels[0].Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) > SqlDate("15.10.2019") ) { 
                     ooutfile.OutputLnF( "В таблице дополнить подпунктом "+ aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc).split(" ").shift()+ " следующего содержания:"+"\n\«"+ aAsgnModels[0].ObjOccListFilter(Constants.OT_FUNC)[0].ObjDef().Name(g_nloc),"Heading 1" ); 
                 createSection33(ooutfile, ArisData.getActiveDatabase(), aAsgnModels);
                 ooutfile.OutputLnF( "\»;","Title 26" );
             }
             {}
              //  ooutfile.EndSection(); 
            }
         //  }
            ooutfile.EndSection();
         }
          }
          {}
      
     }
      
  //  ooutfile.EndSection();   
  } 
  
  
   function outputGraphic(p_Model){
      ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
         var    opicture = p_Model.Graphic(false,false,g_nloc);
           
       //    if (p_Model.Name(g_nloc).startsWith(" Верх") || p_Model.Name(g_nloc).startsWith("3.1.  ") || p_Model.Name(g_nloc).startsWith("3.2.  ") || p_Model.Name(g_nloc).startsWith("3.3.  ") || p_Model.Name(g_nloc).startsWith("3.4.  ")){
           
        //   }else{
    //     if    (p_Model.Name(g_nloc).startsWith("1.")||p_Model.Name(g_nloc).startsWith("2.")||p_Model.Name(g_nloc).startsWith("3.")||p_Model.Name(g_nloc).startsWith("4.")){
         
            if (p_Model.Flags() & Constants.MODEL_PRINT_LANDSCAPE) {
                ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
                LandscapePage(false, ooutfile);
                Footer(ooutfile);
             //   ooutfile.BeginParagraph(Constants.FMT_CENTER,0,0,0,0,0);
               
            if (SqlDate(p_Model.Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) > SqlDate("15.10.2019")&& 
            SqlDate(p_Model.Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020")) 
            {
                ooutfile.OutputLnF( "дополнить подпунктом "+ p_Model.Name(g_nloc).split("  ").shift()+ " следующего содержания:"+"\n\«"+ p_Model.Name(g_nloc),"Heading 1" );
            }                  //slice(p_Model.Name(g_nloc).indexOf(".")+1,p_Model.Name(g_nloc).length(
            if (SqlDate(p_Model.Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020")&& 
            SqlDate(p_Model.Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) < SqlDate("15.10.2019"))
            {
                ooutfile.OutputLnF( "подпункт "+ p_Model.Name(g_nloc).split("  ").shift()+ " изложить в следующей редакции:"+"\n\«"+ p_Model.Name(g_nloc),"Heading 1" ); 
            }
             if (SqlDate(p_Model.Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020"))
            {
                ooutfile.OutputLnF( "подпункт "+ p_Model.Name(g_nloc).split("  ").shift()+ " исключить:"+"\n\«"+ p_Model.Name(g_nloc),"Heading 1" ); 
            }
        //     if (p_Model.Name(g_nloc).startsWith("3.2. 1."))   ooutfile.OutputLnF( "3.2. Обслуживание физических лиц","Heading 1" );
        //     if (p_Model.Name(g_nloc).startsWith("3.3. 1."))   ooutfile.OutputLnF( "3.3. Работа с финансовыми институтами","Heading 1" );
         //    if (p_Model.Name(g_nloc).startsWith("3.4. 1."))   ooutfile.OutputLnF( "3.4. Инвестиционная деятельность","Heading 1" );
            //    ooutfile.OutputLnF( p_Model.Name(g_nloc),"Heading 1" );
                ooutfile.OutGraphic(opicture,-1,257,150);
                ooutfile.OutputLnF( "","Title 6" );
                if (p_Model.Attribute(Constants.AT_REM,g_nloc).GetValue(true).toString()!= ""){
                ooutfile.OutputLnF( "("+p_Model.Attribute(Constants.AT_REM,g_nloc).GetValue(true).toString()+")","Title 16" );
                }
                ooutfile.OutputLnF( "\»;","Title 26" );
              //  ooutfile.EndParagraph();
                ooutfile.EndSection();
            } else {
               
            //    ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
                PortraitPage(false, ooutfile);
                Footer(ooutfile);
          //      ooutfile.BeginParagraph(Constants.FMT_CENTER,0,0,0,0,0);
          if (SqlDate(p_Model.Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) > SqlDate("15.10.2019")&& 
          SqlDate(p_Model.Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020")) 
          {
              ooutfile.OutputLnF( "дополнить подпунктом "+ p_Model.Name(g_nloc).split("  ").shift()+ " следующего содержания:"+"\n\«"+ p_Model.Name(g_nloc),"Heading 1" );
          }
          if (SqlDate(p_Model.Attribute(Constants.AT_VALID_FROM, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020")&& 
          SqlDate(p_Model.Attribute(Constants.AT_CREAT_TIME_STMP, g_nloc).GetValue(true).toString()) < SqlDate("15.10.2019"))
          {
              ooutfile.OutputLnF( "подпункт "+ p_Model.Name(g_nloc).split("  ").shift()+ " изложить в следующей редакции:"+"\n\«"+ p_Model.Name(g_nloc),"Heading 1" ); 
          }
          if (SqlDate(p_Model.Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("17.02.2020"))
            {
                ooutfile.OutputLnF( "подпункт "+ p_Model.Name(g_nloc).split("  ").shift()+ " исключить:"+"\n\«"+ p_Model.Name(g_nloc),"Heading 1" ); 
            }
    //        if (SqlDate(p_Model.Attribute(Constants.AT_VALID_UNTIL, g_nloc).GetValue(true).toString()) > SqlDate("15.03.2019"))   ooutfile.OutputLnF( "подпункт "+ p_Model.Name(g_nloc).split(" ").shift()+ " изложить в следующей редакции:"+"\n\«"+ p_Model.Name(g_nloc),"Heading 1" );   

         //    if (p_Model.Name(g_nloc).startsWith("3.1. 1."))   ooutfile.OutputLnF( "3.1. Обслуживание корпоративных клиентов","Heading 1" );
         //    if (p_Model.Name(g_nloc).startsWith("3.2. 1."))   ooutfile.OutputLnF( "3.2. Обслуживание физических лиц","Heading 1" );
          //   if (p_Model.Name(g_nloc).startsWith("3.3. 1."))   ooutfile.OutputLnF( "3.3. Работа с финансовыми институтами","Heading 1" );
          //   if (p_Model.Name(g_nloc).startsWith("3.4. 1."))   ooutfile.OutputLnF( "3.4. Инвестиционная деятельность","Heading 1" );
            //    ooutfile.OutputLnF( p_Model.Name(g_nloc),"Heading 1" );
                ooutfile.OutGraphic(opicture,-1,165,240);
                ooutfile.OutputLnF( "","Title 6" );
                if (p_Model.Attribute(Constants.AT_REM,g_nloc).GetValue(true).toString()!= ""){
                ooutfile.OutputLnF( "("+p_Model.Attribute(Constants.AT_REM,g_nloc).GetValue(true).toString()+")","Title 16" );
                }
               ooutfile.OutputLnF( "\»;","Title 26" );
            //    ooutfile.EndParagraph();
                ooutfile.EndSection();
            }
         //   ooutfile.EndSection();
       //   }
//   }
        }
     //   ooutfile.EndSection(); 
     

 //this.parentBpid = this.occ.ObjDef().getConnectedObjs([Constants.OT_FUNC],Constants.EDGES_IN,[Constants.CT_IS_PRCS_ORNT_SUPER])[0].Identifier (g_nLoc).slice(arisobjOcc.ObjDef().Identifier(g_nLoc).indexOf(".")+1,arisobjOcc.ObjDef().Identifier (g_nLoc).length());

   
   
function sortDefsNames( a, b ){
        var valA    = getAttrStrValue( a, Constants.AT_NAME, gn_Lang );
        var valB    = getAttrStrValue( b, Constants.AT_NAME, gn_Lang );
        return valA.compareToIgnoreCase( valB );
    }//END::sortDefsNames()

function getAttrStrValue(p_objDef, p_attrTypeNum, p_Lang){
        var attr    = p_objDef.Attribute(p_attrTypeNum, p_Lang, true);
        if(attr.IsValid() == false) return gs_Empty;
        return Packages.java.lang.String( attr.GetValue(true) );//convToBytes( attr.GetValue(true) ) );
    }//END::getAttrStrValue()    
 
function getFStyle(p_Level){
        if (p_Level == 0) return "Heading 0";
        if (p_Level == 1) return "Heading 1";
        if (p_Level == 2) return "Heading 2";
        return "Heading 3";
    } 
 
 

function LandscapePage(beginsection, outfile) {
    
    if (beginsection == true) outfile.BeginSection(true, Constants.SECTION_DEFAULT);
    outfile.SetPageWidth(297);	 
    outfile.SetPageHeight(210);
    outfile.SetLeftMargin(20);
    outfile.SetRightMargin(20);
    outfile.SetTopMargin(30);
    outfile.SetBottomMargin(10);
    outfile.SetDistFooter(10);
}

function PortraitPage(beginsection, outfile) {
    
    if (beginsection == true) outfile.BeginSection(true, Constants.SECTION_DEFAULT);    
    outfile.SetPageWidth(210);	 
    outfile.SetPageHeight(297);
    outfile.SetLeftMargin(30);
    outfile.SetRightMargin(10);
    outfile.SetTopMargin(20);
    outfile.SetBottomMargin(20);
    outfile.SetDistFooter(10);
}    

function SqlDate(dateAris){
    
    if (dateAris == "") return "";    
    //задаем формат исходной текстовой даты
    var formatForParse = new java.text.SimpleDateFormat("dd.MM.yyyy");  
    //переводим строковую дату в формат "дата"
    var date = formatForParse.parse(dateAris);            
    //задаем формат преобразования даты
    var sqlFormat = new java.text.SimpleDateFormat("yyyy-MM-dd");  
    //преобразуем
    
    return sqlFormat.format(date);
}

function EndSection(outfile) {
    
    outfile.EndSection();  
}

function Footer(outfile) {
    
    var image = undefined;
    outfile.BeginFooter();
    outfile.BeginTable(100,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER,0);
    outfile.TableRow();
    outfile.TableCellF("",35,"Footer");
    image = Context.createPicture("LogoAPB.jpg");
    outfile.OutGraphic(image,-1,30,30);
    outfile.TableCellF("",35,"Footer");
    outfile.BeginParagraph(Constants.FMT_CENTER,0,0,0,0,0);
    outfile.OutputF(getString("TEXT_1"),"Footer");
    outfile.EndParagraph();
    outfile.TableCellF("",30,"Footer");
    outfile.BeginParagraph(Constants.FMT_CENTER,0,0,0,0,0);
    outfile.OutputF("Стр.","Footer");
    ooutfile.OutputField(Constants.FIELD_PAGE,"Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER);
    outfile.OutputF(" из ","Footer");
    ooutfile.OutputField(Constants.FIELD_NUMPAGES,"Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_CENTER);
    outfile.EndParagraph();
    outfile.EndTable("",100,"Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,0,Constants.FMT_CENTER,0);
    outfile.EndFooter();
}

function ToC(ooutfile) {
    ooutfile.BeginSection(false, Constants.SECTION_INDEX);
    Footer(ooutfile);
    ooutfile.SetAutoTOCNumbering(false);
    for (var i=0; i<=3; i++)
        ooutfile.SetTOCFormat(i, "Times New Roman", 10 , Constants.C_BLACK, Constants.C_WHITE, Constants.FMT_LEFT, i*3, 0, 0, 0);
    ooutfile.OutputLn("Содержание", "Times New Roman",12,Constants.C_BLACK,Constants.C_TRANSPARENT,Constants.FMT_BOLD | Constants.FMT_LEFT,0);
    ooutfile.OutputField(Constants.FIELD_TOC, "Times New Roman",10, Constants.C_BLACK, Constants.C_WHITE, Constants.FMT_LEFT);
    ooutfile.EndSection();  
}



function createSection33(ooutfile, p_aDatabase, aOut)
{
   var  aOut1 = new Array;
    var  aOut2 = new Array;
    var  aOut3 = new Array;
   // ooutfile.BeginSection(false, Constants.SECTION_DEFAULT);
	if(p_aDatabase.length==0)
		return;

        if (aOut.length > 0) {
  
    LandscapePage(false, ooutfile);
    Footer(ooutfile);
    
         iteration_group66(ooutfile, aOut);
    } 
  
    }                  
 

function iteration_group66(p_output, p_aModel)
		{
    
			for(var i1=0; i1<p_aModel.length; i1++) {
	            var  p_aObjDef = ArisData.sort(p_aModel[i1].ObjOccListFilter([Constants.OT_FUNC]),Constants.AT_HIER_NUM, nLocale);     
                          
     
                    ArisData.sort(p_aObjDef,Constants.AT_HIER_NUM, nLocale);
                 
				
             var  p_aObjDef1 = collect(p_aObjDef);
             var  p_aObjDef2 = collect1(p_aObjDef);
             var  p_aObjDef3 = collect2(p_aObjDef);
             var  p_aObjDef4 = collect3(p_aObjDef);
             var  p_aObjDef5 = collect4(p_aObjDef);
               
 					
							p_output.BeginTable(100, RGB(0,0,0), RGB(255,255,255),  Constants.FMT_LEFT, 0);
							
						//		p_output.TableRow();
						//			p_output.ResetFrameStyle();
									
                                    
                                                                        
                                     p_output.TableCellF("", 14, "TableMain");
								p_output.BeginParagraph( Constants.FMT_LEFT, 0.71, 0.71, 0, 0, 0);
							
                            for(var iter=0; iter<p_aObjDef.length; iter++){
                            if ( DetectIndentFromNumber(p_aObjDef[iter]) == 1 ){
                                p_output.OutputLn(p_aObjDef[iter].ObjDef().Name(g_nloc), "Times New Roman", 11, RGB(0,0,0), Constants.C_TRANSPARENT,  Constants.FMT_LEFT, 0.71); 
								
                            }
                         
                         
                                if ( (DetectIndentFromNumber(p_aObjDef[iter]) == 2 || DetectIndentFromNumber(p_aObjDef[iter]) == 3) ){ 
                            
                                
                                  var aAsgnModels = (p_aObjDef[iter].ObjDef().getConnectedObjs([Constants.OT_FUNC],Constants.EDGES_IN, [Constants.CT_IS_PRCS_ORNT_SUPER]))[0].Name(g_nloc); 
                                
                                p_output.OutputLn(aAsgnModels, "Times New Roman", 11, RGB(0,0,0), Constants.C_TRANSPARENT,  Constants.FMT_LEFT, 0.71);                         
                               
                          }
                            }
							   p_output.EndParagraph();
							
                                     
                                     p_output.TableCellF("", 14, "TableMain");
								p_output.BeginParagraph( Constants.FMT_LEFT, 0.71, 0.71, 0, 0, 0);
                               
                                for(var iter=0; iter<p_aObjDef.length; iter++){
                            if ( DetectIndentFromNumber(p_aObjDef[iter]) == 2 || DetectIndentFromNumber(p_aObjDef[iter]) == 3 ){ 
                           //  for(var iter=0; iter<p_aObjDef.length; iter++) {
                               ArisData.sort(p_aObjDef,Constants.AT_HIER_NUM, nLocale);
								p_output.OutputLn(p_aObjDef[iter].ObjDef().Name(g_nloc), "Times New Roman", 11, RGB(0,0,0), Constants.C_TRANSPARENT,  Constants.FMT_LEFT, 0.71);
							} 
                             
                            }
                            
                             p_output.EndParagraph();
                            
                                    p_output.TableCellF("", 20, "TableMain");
							   p_output.BeginParagraph( Constants.FMT_LEFT, 0.35, 0.71, 0, 0, 0);
							   for(var iter=0; iter<p_aObjDef3.length; iter++) {
							    p_output.Output(p_aObjDef3[iter], "Times New Roman", 11, RGB(0,0,0), Constants.C_TRANSPARENT,  Constants.FMT_LEFT, 0.71);
							}
							   p_output.EndParagraph()
									
                                    
                                    p_output.TableCellF("", 13, "TableMain");
								p_output.BeginParagraph( Constants.FMT_LEFT, 0.71, 0.71, 0, 0, 0);
							   for(var iter=0; iter<p_aObjDef2.length; iter++) {
                                p_output.OutputLn(p_aObjDef2[iter].ObjDef().Name(g_nloc), "Times New Roman", 11, RGB(0,0,0), Constants.C_TRANSPARENT,  Constants.FMT_LEFT, 0.35);
							}
								p_output.EndParagraph();
									
                                    
                                                                       
                                    p_output.TableCellF("", 19.5, "TableMain");
								p_output.BeginParagraph( Constants.FMT_LEFT, 0.71, 0.71, 0, 0, 0);
                               for(var iter=0; iter<p_aObjDef4.length; iter++) {
                                p_output.Output( p_aObjDef4[iter], "Times New Roman", 11, RGB(0,0,0), Constants.C_TRANSPARENT,  Constants.FMT_LEFT, 0.35);  
							}
								p_output.EndParagraph();
									
                                    
                                    p_output.TableCellF("", 19.5, "TableMain");
								p_output.BeginParagraph( Constants.FMT_LEFT, 0.35, 0.71, 0, 0, 0);
							   for(var iter=0; iter<p_aObjDef5.length; iter++) {
							   p_output.Output(p_aObjDef5[iter], "Times New Roman", 11, RGB(0,0,0), Constants.C_TRANSPARENT,  Constants.FMT_LEFT, 0.71);
							}
								p_output.EndParagraph();

							
								p_output.EndTable("", 100, "Times New Roman", 10, Constants.C_BLACK, Constants.C_TRANSPARENT, 0, Constants.FMT_LEFT, 0);
						}
        }
   
						
                        
function collect5(p_array){
							var result = new Array();
							for(var i=0; i<p_array.length; i++){
								result.push(p_array[i]);
							}
							return ArisData.Unique(result);
						}
					
                    
function collect4(p_array){
							 var strExits = new String();
                        for(var i=0; i<p_array.length; i++){
					        var ObjOccsOut = p_array[i].getConnectedObjOccs([Constants.ST_PACK],Constants.EDGES_OUT); 
                         
                        } 
                            var tempstring = "";   
                            for (var i = 0; i < ObjOccsOut.length; ++i) 
                      {
                       tempstring  = ObjOccsOut[i].getObjDefName(g_nloc).trim()+ "" + ObjOccsOut[i].ObjDef().Attribute(Constants.AT_DESC,g_nloc).GetValue(true).trim();
                       strExits=strExits+tempstring+(i<ObjOccsOut.length ?  ". " : "");
                   }
                      return   strExits.substring(0,strExits.length-1).replace("..","."); 
                     }
                    
                    
function collect2(p_array){
						
                         var strExits = new String();
                        for(var i=0; i<p_array.length; i++){
					        var ObjOccsOut = p_array[i].getConnectedObjOccs([Constants.ST_OBJCTV],Constants.EDGES_INOUT); 
                        }
                            var tempstring = "";   
                            for (var i = 0; i < ObjOccsOut.length; ++i) 
                      {
                       tempstring  = ObjOccsOut[i].getObjDefName(g_nloc).trim()+ ". ";
                       strExits=strExits+tempstring;
                   }
                 return   strExits.substring(0,strExits.length-1); 
                  }
                       
                  
function collect3(p_array){
						 var strExits = new String();
                        for(var i=0; i<p_array.length; i++){
					        var ObjOccsOut = p_array[i].getConnectedObjOccs([Constants.ST_PACK],Constants.EDGES_IN); 
                        }
                            var tempstring = "";   
                            for (var i = 0; i < ObjOccsOut.length; ++i) 
                      {
                       tempstring  = ObjOccsOut[i].getObjDefName(g_nloc).trim()+ " " + ObjOccsOut[i].ObjDef().Attribute(Constants.AT_DESC,g_nloc).GetValue(true).trim();
                       strExits=strExits+tempstring+(i<ObjOccsOut.length ?  ". " : "");
                }
                   return   strExits.substring(0,strExits.length-1).replace("..","."); 
                 }
                    
                    
                    
function collect1(p_array){
						var result = new Array();
						for(var i=0; i<p_array.length; i++){
							result = result.concat(p_array[i].getConnectedObjOccs([Constants.ST_EMPL_TYPE, Constants.ST_GRP], Constants.EDGES_INOUT));   
						}
						return ArisData.Unique(result);
					}
function collect(p_array){
						var result = new Array();
						for(var i=0; i<p_array.length; i++){
						}
						return ArisData.Unique(result);
					}
 


function RGB(r, g, b) {
	return (new java.awt.Color(r/255.0,g/255.0,b/255.0,1)).getRGB() & 0xFFFFFF;
}


function DeleteNumSpaces(Name)
{   
    Name = String(Name);
    var NameArr = Name.match(/\d./g);
    if (NameArr != null) {
        if (NameArr.length > 0) {
            var posIndex = Name.lastIndexOf(NameArr[NameArr.length-1]);
            if (posIndex == -1) return Name
            else {    
                var BPNum = Name.substring(0,posIndex).replace(" ","");
                var BPName = Name.substring(posIndex, Name.length);
                var Result = BPNum + BPName;
                return Result
            }
        } else return Name;
    } else return Name;
}


function DetectIndentFromNumber(oObjOcc)
{   
    var match = null;  
    var indent = 0;
    match = oObjOcc.ObjDef().Name(g_nloc).match(/\d./g);  
    if (match == null) return 0;
    else {
       indent = match.length-1; 
       if (indent < 0 ) indent = 0;
       if (indent >= 5) indent = 4; 
       return indent; 
    }
}


function compareNumeric(a, b) {
  if (a > b) return 1;
  if (a == b) return 0;
  if (a < b) return -1;
}

function naturalSort(a, b) {
	"use strict";
	var re = /(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,
		sre = /(^[ ]*|[ ]*$)/g,
		dre = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,
		hre = /^0x[0-9a-f]+$/i,
		ore = /^0/,
		i = function(s) { return naturalSort.insensitive && ('' + s).toLowerCase() || '' + s; },
		// convert all to strings strip whitespace
		x = i(a).replace(sre, '') || '',
		y = i(b).replace(sre, '') || '',
		// chunk/tokenize
		xN = x.replace(re, '\0$1\0').replace(/\0$/,'').replace(/^\0/,'').split('\0'),
		yN = y.replace(re, '\0$1\0').replace(/\0$/,'').replace(/^\0/,'').split('\0'),
		// numeric, hex or date detection
		xD = parseInt(x.match(hre), 16) || (xN.length !== 1 && x.match(dre) && Date.parse(x)),
		yD = parseInt(y.match(hre), 16) || xD && y.match(dre) && Date.parse(y) || null,
		oFxNcL, oFyNcL;
	// first try and sort Hex codes or Dates
	if (yD) {
		if ( xD < yD ) { return -1; }
		else if ( xD > yD ) { return 1; }
	}
	// natural sorting through split numeric strings and default strings
	for(var cLoc=0, numS=Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {
		// find floats not starting with '0', string or 0 if not defined (Clint Priest)
		oFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;
		oFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0;
		// handle numeric vs string comparison - number < string - (Kyle Adams)
		if (isNaN(oFxNcL) !== isNaN(oFyNcL)) { return (isNaN(oFxNcL)) ? 1 : -1; }
		// rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'
		else if (typeof oFxNcL !== typeof oFyNcL) {
			oFxNcL += '';
			oFyNcL += '';
		}
		if (oFxNcL < oFyNcL) { return -1; }
		if (oFxNcL > oFyNcL) { return 1; }
	}
	return 0;
}


}
main();
